<div class="break-words"><div><div class="FN9Jv WRmCx"><p><a href="https://cses.fi/problemset/task/1648/" target="_blank">https://cses.fi/problemset/task/1648/</a></p>
<p>Using Segmentation Tree</p>
<ul>
<li>The left child of a vertex at index i is stored at index 2i, and the right one at index 2i+1.</li>
<li>The root of the Segment Tree represents the whole array A[0 : N-1] . Then it's left and right children will represent the array A[0 : (N-1) / 2] and A[ (N-1) / 2 + 1 : (N-1) ] respectively.</li>
<li>The starting vertex is 1 ( for i=0 , 2i will also remain zero ).</li>
</ul>
<div class="mb-6 rounded-lg px-3 py-2.5 font-menlo text-sm bg-fill-3 dark:bg-dark-fill-3"><div class="group relative" translate="no"><pre style=" font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 0px; margin: 0px; overflow: auto; background: transparent;"><code class="language-cpp" style=' font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;'><span><span class="token macro directive-hash">#</span><span class="token macro directive">include</span><span class="token macro">&lt;bits/stdc++.h&gt;</span><span>
</span></span><span><span></span><span class="token">using</span><span> </span><span class="token">namespace</span><span> std</span><span class="token">;</span><span>
</span></span><span> 
</span><span><span>vector</span><span class="token">&lt;</span><span class="token">long</span><span> </span><span class="token">long</span><span class="token">&gt;</span><span>st</span><span class="token">;</span><span>
</span></span><span><span></span><span class="token">void</span><span> </span><span class="token">build</span><span class="token">(</span><span class="token">int</span><span> v</span><span class="token">,</span><span class="token">int</span><span> start</span><span class="token">,</span><span class="token">int</span><span> end</span><span class="token">,</span><span>vector</span><span class="token">&lt;</span><span class="token">int</span><span class="token">&gt;</span><span class="token">&amp;</span><span>arr</span><span class="token">)</span><span class="token">{</span><span>                 </span><span class="token">// v is vertex of tree, start is left boundry of vertex, end is right boudry of vertex</span><span>
</span></span><span><span>    </span><span class="token">if</span><span class="token">(</span><span>start</span><span class="token">==</span><span>end</span><span class="token">)</span><span> st</span><span class="token">[</span><span>v</span><span class="token">]</span><span class="token">=</span><span>arr</span><span class="token">[</span><span>start</span><span class="token">]</span><span class="token">;</span><span>
</span></span><span><span>    </span><span class="token">else</span><span class="token">{</span><span>
</span></span><span><span>        </span><span class="token">int</span><span> mid</span><span class="token">=</span><span class="token">(</span><span>start</span><span class="token">+</span><span>end</span><span class="token">)</span><span class="token">/</span><span class="token">2</span><span class="token">;</span><span>
</span></span><span><span>        </span><span class="token">build</span><span class="token">(</span><span class="token">2</span><span class="token">*</span><span>v</span><span class="token">,</span><span>start</span><span class="token">,</span><span>mid</span><span class="token">,</span><span>arr</span><span class="token">)</span><span class="token">;</span><span>
</span></span><span><span>        </span><span class="token">build</span><span class="token">(</span><span class="token">2</span><span class="token">*</span><span>v</span><span class="token">+</span><span class="token">1</span><span class="token">,</span><span>mid</span><span class="token">+</span><span class="token">1</span><span class="token">,</span><span>end</span><span class="token">,</span><span>arr</span><span class="token">)</span><span class="token">;</span><span>
</span></span><span><span>        st</span><span class="token">[</span><span>v</span><span class="token">]</span><span class="token">=</span><span>st</span><span class="token">[</span><span class="token">2</span><span class="token">*</span><span>v</span><span class="token">]</span><span class="token">+</span><span>st</span><span class="token">[</span><span class="token">2</span><span class="token">*</span><span>v</span><span class="token">+</span><span class="token">1</span><span class="token">]</span><span class="token">;</span><span>                   </span><span class="token">//  the operation we want to perform</span><span>
</span></span><span><span>    </span><span class="token">}</span><span>
</span></span><span><span></span><span class="token">}</span><span>
</span></span><span> 
</span><span><span></span><span class="token">void</span><span> </span><span class="token">update</span><span class="token">(</span><span class="token">int</span><span> v</span><span class="token">,</span><span class="token">int</span><span> start</span><span class="token">,</span><span class="token">int</span><span> end</span><span class="token">,</span><span class="token">int</span><span> i</span><span class="token">,</span><span class="token">int</span><span> x</span><span class="token">)</span><span class="token">{</span><span>
</span></span><span><span>    </span><span class="token">if</span><span class="token">(</span><span>start</span><span class="token">==</span><span>end</span><span class="token">)</span><span> st</span><span class="token">[</span><span>v</span><span class="token">]</span><span class="token">=</span><span>x</span><span class="token">;</span><span>
</span></span><span><span>    </span><span class="token">else</span><span class="token">{</span><span>
</span></span><span><span>        </span><span class="token">int</span><span> mid</span><span class="token">=</span><span class="token">(</span><span>start</span><span class="token">+</span><span>end</span><span class="token">)</span><span class="token">/</span><span class="token">2</span><span class="token">;</span><span>
</span></span><span><span>        </span><span class="token">if</span><span class="token">(</span><span>i</span><span class="token">&lt;=</span><span>mid</span><span class="token">)</span><span> </span><span class="token">update</span><span class="token">(</span><span class="token">2</span><span class="token">*</span><span>v</span><span class="token">,</span><span>start</span><span class="token">,</span><span>mid</span><span class="token">,</span><span>i</span><span class="token">,</span><span>x</span><span class="token">)</span><span class="token">;</span><span>
</span></span><span><span>        </span><span class="token">else</span><span> </span><span class="token">update</span><span class="token">(</span><span class="token">2</span><span class="token">*</span><span>v</span><span class="token">+</span><span class="token">1</span><span class="token">,</span><span>mid</span><span class="token">+</span><span class="token">1</span><span class="token">,</span><span>end</span><span class="token">,</span><span>i</span><span class="token">,</span><span>x</span><span class="token">)</span><span class="token">;</span><span>
</span></span><span><span>        st</span><span class="token">[</span><span>v</span><span class="token">]</span><span class="token">=</span><span>st</span><span class="token">[</span><span class="token">2</span><span class="token">*</span><span>v</span><span class="token">]</span><span class="token">+</span><span>st</span><span class="token">[</span><span class="token">2</span><span class="token">*</span><span>v</span><span class="token">+</span><span class="token">1</span><span class="token">]</span><span class="token">;</span><span>             </span><span class="token">//  the operation we want to perform</span><span>
</span></span><span><span>    </span><span class="token">}</span><span>
</span></span><span><span></span><span class="token">}</span><span>
</span></span><span> 
</span><span><span></span><span class="token">long</span><span> </span><span class="token">long</span><span> </span><span class="token">query</span><span class="token">(</span><span class="token">int</span><span> v</span><span class="token">,</span><span class="token">int</span><span> start</span><span class="token">,</span><span class="token">int</span><span> end</span><span class="token">,</span><span class="token">int</span><span> l</span><span class="token">,</span><span class="token">int</span><span> r</span><span class="token">)</span><span class="token">{</span><span>
</span></span><span><span>    </span><span class="token">if</span><span class="token">(</span><span>l</span><span class="token">&gt;</span><span>r</span><span class="token">)</span><span> </span><span class="token">return</span><span> </span><span class="token">0</span><span class="token">;</span><span>                       </span><span class="token">// in some case return value change to INT_MIN or INT_MAX</span><span>
</span></span><span><span>    </span><span class="token">if</span><span class="token">(</span><span>l</span><span class="token">==</span><span>start </span><span class="token">&amp;&amp;</span><span> r</span><span class="token">==</span><span>end</span><span class="token">)</span><span> </span><span class="token">return</span><span> st</span><span class="token">[</span><span>v</span><span class="token">]</span><span class="token">;</span><span>
</span></span><span><span>    </span><span class="token">int</span><span> mid</span><span class="token">=</span><span class="token">(</span><span>start</span><span class="token">+</span><span>end</span><span class="token">)</span><span class="token">/</span><span class="token">2</span><span class="token">;</span><span>
</span></span><span><span>    </span><span class="token">return</span><span> </span><span class="token">query</span><span class="token">(</span><span class="token">2</span><span class="token">*</span><span>v</span><span class="token">,</span><span>start</span><span class="token">,</span><span>mid</span><span class="token">,</span><span>l</span><span class="token">,</span><span class="token">min</span><span class="token">(</span><span>r</span><span class="token">,</span><span>mid</span><span class="token">)</span><span class="token">)</span><span class="token">+</span><span class="token">query</span><span class="token">(</span><span class="token">(</span><span class="token">2</span><span class="token">*</span><span>v</span><span class="token">)</span><span class="token">+</span><span class="token">1</span><span class="token">,</span><span>mid</span><span class="token">+</span><span class="token">1</span><span class="token">,</span><span>end</span><span class="token">,</span><span class="token">max</span><span class="token">(</span><span>l</span><span class="token">,</span><span>mid</span><span class="token">+</span><span class="token">1</span><span class="token">)</span><span class="token">,</span><span>r</span><span class="token">)</span><span class="token">;</span><span>     </span><span class="token">//  the operation we want to perform</span><span>
</span></span><span><span></span><span class="token">}</span><span>
</span></span><span> 
</span><span><span></span><span class="token">int</span><span> </span><span class="token">main</span><span class="token">(</span><span class="token">)</span><span class="token">{</span><span>
</span></span><span><span>    </span><span class="token">int</span><span> n</span><span class="token">,</span><span>q</span><span class="token">;</span><span>
</span></span><span><span>    cin</span><span class="token">&gt;&gt;</span><span>n</span><span class="token">&gt;&gt;</span><span>q</span><span class="token">;</span><span>
</span></span><span><span>    st</span><span class="token">.</span><span class="token">assign</span><span class="token">(</span><span class="token">4</span><span class="token">*</span><span>n</span><span class="token">,</span><span class="token">0</span><span class="token">)</span><span class="token">;</span><span>                             </span><span class="token">// https://stackoverflow.com/questions/19673311/stl-vector-resize-and-assign</span><span>
</span></span><span><span>    vector</span><span class="token">&lt;</span><span class="token">int</span><span class="token">&gt;</span><span class="token">arr</span><span class="token">(</span><span>n</span><span class="token">)</span><span class="token">;</span><span>
</span></span><span><span>    </span><span class="token">for</span><span class="token">(</span><span class="token">int</span><span> i</span><span class="token">=</span><span class="token">0</span><span class="token">;</span><span>i</span><span class="token">&lt;</span><span>n</span><span class="token">;</span><span class="token">++</span><span>i</span><span class="token">)</span><span class="token">{</span><span>
</span></span><span><span>        cin</span><span class="token">&gt;&gt;</span><span>arr</span><span class="token">[</span><span>i</span><span class="token">]</span><span class="token">;</span><span>
</span></span><span><span>    </span><span class="token">}</span><span>
</span></span><span><span>    </span><span class="token">build</span><span class="token">(</span><span class="token">1</span><span class="token">,</span><span class="token">0</span><span class="token">,</span><span>n</span><span class="token">-</span><span class="token">1</span><span class="token">,</span><span>arr</span><span class="token">)</span><span class="token">;</span><span>                         </span><span class="token">// build</span><span>
</span></span><span><span>    </span><span class="token">while</span><span class="token">(</span><span>q</span><span class="token">--</span><span class="token">)</span><span class="token">{</span><span>
</span></span><span><span>        </span><span class="token">int</span><span> o</span><span class="token">;</span><span>
</span></span><span><span>        cin</span><span class="token">&gt;&gt;</span><span>o</span><span class="token">;</span><span>
</span></span><span><span>        </span><span class="token">if</span><span class="token">(</span><span>o</span><span class="token">==</span><span class="token">1</span><span class="token">)</span><span class="token">{</span><span>
</span></span><span><span>            </span><span class="token">int</span><span> i</span><span class="token">,</span><span>x</span><span class="token">;</span><span>
</span></span><span><span>            cin</span><span class="token">&gt;&gt;</span><span>i</span><span class="token">&gt;&gt;</span><span>x</span><span class="token">;</span><span>
</span></span><span><span>            </span><span class="token">--</span><span>i</span><span class="token">;</span><span>
</span></span><span><span>            </span><span class="token">update</span><span class="token">(</span><span class="token">1</span><span class="token">,</span><span class="token">0</span><span class="token">,</span><span>n</span><span class="token">-</span><span class="token">1</span><span class="token">,</span><span>i</span><span class="token">,</span><span>x</span><span class="token">)</span><span class="token">;</span><span>                </span><span class="token">// update</span><span>
</span></span><span><span>        </span><span class="token">}</span><span class="token">else</span><span class="token">{</span><span>
</span></span><span><span>            </span><span class="token">int</span><span> l</span><span class="token">,</span><span>r</span><span class="token">;</span><span>
</span></span><span><span>            cin</span><span class="token">&gt;&gt;</span><span>l</span><span class="token">&gt;&gt;</span><span>r</span><span class="token">;</span><span>
</span></span><span><span>            </span><span class="token">--</span><span>l</span><span class="token">;</span><span>
</span></span><span><span>            </span><span class="token">--</span><span>r</span><span class="token">;</span><span>
</span></span><span><span>            cout</span><span class="token">&lt;&lt;</span><span class="token">query</span><span class="token">(</span><span class="token">1</span><span class="token">,</span><span class="token">0</span><span class="token">,</span><span>n</span><span class="token">-</span><span class="token">1</span><span class="token">,</span><span>l</span><span class="token">,</span><span>r</span><span class="token">)</span><span class="token">&lt;&lt;</span><span>endl</span><span class="token">;</span><span>       </span><span class="token">// query</span><span>
</span></span><span><span>        </span><span class="token">}</span><span>
</span></span><span><span>    </span><span class="token">}</span><span>
</span></span><span><span></span><span class="token">}</span></span></code></pre><div class="absolute -right-1.5 -top-0.5 flex gap-2"><div class="z-base-1 hidden rounded border group-hover:block border-border-quaternary dark:border-border-quaternary bg-layer-02 dark:bg-layer-02"><div class="relative cursor-pointer flex h-[22px] w-[22px] items-center justify-center bg-layer-02 dark:bg-layer-02 hover:bg-fill-tertiary dark:hover:bg-fill-tertiary rounded-[4px]" data-state="closed"><div><div data-state="closed"><div class="relative text-[12px] leading-[normal] p-[1px] before:block before:h-3 before:w-3 h-3.5 w-3.5 text-text-primary dark:text-text-primary"></div></div></div></div></div></div></div></div>
<p>Fenwick tree</p>
<div class="mb-6 rounded-lg px-3 py-2.5 font-menlo text-sm bg-fill-3 dark:bg-dark-fill-3"><div class="group relative" translate="no"><pre style=" font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 0px; margin: 0px; overflow: auto; background: transparent;"><code class="language-cpp" style=' font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;'><span><span class="token macro directive-hash">#</span><span class="token macro directive">include</span><span class="token macro">&lt;bits/stdc++.h&gt;</span><span>
</span></span><span><span></span><span class="token">using</span><span> </span><span class="token">namespace</span><span> std</span><span class="token">;</span><span>
</span></span><span> 
</span><span><span>vector</span><span class="token">&lt;</span><span class="token">long</span><span> </span><span class="token">long</span><span class="token">&gt;</span><span>bit</span><span class="token">;</span><span>
</span></span><span> 
</span><span><span></span><span class="token">void</span><span> </span><span class="token">update</span><span class="token">(</span><span class="token">int</span><span> i</span><span class="token">,</span><span> </span><span class="token">int</span><span> x</span><span class="token">)</span><span class="token">{</span><span>
</span></span><span><span>    </span><span class="token">int</span><span> n</span><span class="token">=</span><span>bit</span><span class="token">.</span><span class="token">size</span><span class="token">(</span><span class="token">)</span><span class="token">;</span><span>
</span></span><span><span>	</span><span class="token">for</span><span class="token">(</span><span class="token">;</span><span> i </span><span class="token">&lt;</span><span> n</span><span class="token">;</span><span> i </span><span class="token">+=</span><span> </span><span class="token">(</span><span>i</span><span class="token">&amp;</span><span class="token">-</span><span>i</span><span class="token">)</span><span class="token">)</span><span>
</span></span><span><span>		bit</span><span class="token">[</span><span>i</span><span class="token">]</span><span> </span><span class="token">+=</span><span> x</span><span class="token">;</span><span>
</span></span><span><span></span><span class="token">}</span><span>
</span></span><span> 
</span><span><span></span><span class="token">long</span><span> </span><span class="token">long</span><span> </span><span class="token">sum</span><span class="token">(</span><span class="token">int</span><span> i</span><span class="token">)</span><span class="token">{</span><span>
</span></span><span><span>	</span><span class="token">long</span><span> </span><span class="token">long</span><span> ans </span><span class="token">=</span><span> </span><span class="token">0</span><span class="token">;</span><span>
</span></span><span><span>	</span><span class="token">for</span><span class="token">(</span><span class="token">;</span><span> i </span><span class="token">&gt;</span><span> </span><span class="token">0</span><span class="token">;</span><span> i </span><span class="token">-=</span><span> </span><span class="token">(</span><span>i</span><span class="token">&amp;</span><span class="token">-</span><span>i</span><span class="token">)</span><span class="token">)</span><span>
</span></span><span><span>		ans </span><span class="token">+=</span><span> bit</span><span class="token">[</span><span>i</span><span class="token">]</span><span class="token">;</span><span>
</span></span><span><span>	</span><span class="token">return</span><span> ans</span><span class="token">;</span><span>
</span></span><span><span></span><span class="token">}</span><span>
</span></span><span> 
</span><span><span></span><span class="token">int</span><span> </span><span class="token">main</span><span class="token">(</span><span class="token">)</span><span class="token">{</span><span>
</span></span><span><span>	</span><span class="token">int</span><span> n</span><span class="token">,</span><span> q</span><span class="token">;</span><span>
</span></span><span><span>	cin </span><span class="token">&gt;&gt;</span><span> n </span><span class="token">&gt;&gt;</span><span> q</span><span class="token">;</span><span>
</span></span><span><span>	vector</span><span class="token">&lt;</span><span class="token">int</span><span class="token">&gt;</span><span class="token">arr</span><span class="token">(</span><span>n</span><span class="token">+</span><span class="token">1</span><span class="token">)</span><span class="token">;</span><span>
</span></span><span><span>    bit</span><span class="token">.</span><span class="token">resize</span><span class="token">(</span><span>n</span><span class="token">+</span><span class="token">1</span><span class="token">)</span><span class="token">;</span><span>
</span></span><span><span>	</span><span class="token">for</span><span class="token">(</span><span class="token">int</span><span> i </span><span class="token">=</span><span> </span><span class="token">1</span><span class="token">;</span><span>i </span><span class="token">&lt;=</span><span> n</span><span class="token">;</span><span> </span><span class="token">++</span><span>i</span><span class="token">)</span><span class="token">{</span><span>
</span></span><span><span>		cin </span><span class="token">&gt;&gt;</span><span> arr</span><span class="token">[</span><span>i</span><span class="token">]</span><span class="token">;</span><span>
</span></span><span><span>		</span><span class="token">update</span><span class="token">(</span><span>i</span><span class="token">,</span><span> arr</span><span class="token">[</span><span>i</span><span class="token">]</span><span class="token">)</span><span class="token">;</span><span>
</span></span><span><span>	</span><span class="token">}</span><span>
</span></span><span> 
</span><span><span>	</span><span class="token">while</span><span class="token">(</span><span>q</span><span class="token">--</span><span class="token">)</span><span class="token">{</span><span>
</span></span><span><span>		</span><span class="token">int</span><span> type</span><span class="token">;</span><span>
</span></span><span><span>		cin </span><span class="token">&gt;&gt;</span><span> type</span><span class="token">;</span><span>
</span></span><span><span>		</span><span class="token">if</span><span class="token">(</span><span>type </span><span class="token">==</span><span> </span><span class="token">1</span><span class="token">)</span><span class="token">{</span><span>
</span></span><span><span>			</span><span class="token">int</span><span> i</span><span class="token">,</span><span> x</span><span class="token">;</span><span>
</span></span><span><span>			cin </span><span class="token">&gt;&gt;</span><span> i </span><span class="token">&gt;&gt;</span><span> x</span><span class="token">;</span><span>
</span></span><span><span>			</span><span class="token">update</span><span class="token">(</span><span>i</span><span class="token">,</span><span> x </span><span class="token">-</span><span> arr</span><span class="token">[</span><span>i</span><span class="token">]</span><span class="token">)</span><span class="token">;</span><span>
</span></span><span><span>			arr</span><span class="token">[</span><span>i</span><span class="token">]</span><span> </span><span class="token">=</span><span> x</span><span class="token">;</span><span>
</span></span><span><span>		</span><span class="token">}</span><span>
</span></span><span><span>		</span><span class="token">else</span><span class="token">{</span><span>
</span></span><span><span>			</span><span class="token">int</span><span> l</span><span class="token">,</span><span> r</span><span class="token">;</span><span>
</span></span><span><span>			cin </span><span class="token">&gt;&gt;</span><span> l </span><span class="token">&gt;&gt;</span><span> r</span><span class="token">;</span><span>
</span></span><span><span>			cout </span><span class="token">&lt;&lt;</span><span> </span><span class="token">sum</span><span class="token">(</span><span>r</span><span class="token">)</span><span> </span><span class="token">-</span><span> </span><span class="token">sum</span><span class="token">(</span><span>l</span><span class="token">-</span><span class="token">1</span><span class="token">)</span><span> </span><span class="token">&lt;&lt;</span><span> endl</span><span class="token">;</span><span>
</span></span><span><span>		</span><span class="token">}</span><span>
</span></span><span><span>	</span><span class="token">}</span><span>
</span></span><span><span></span><span class="token">}</span></span></code></pre><div class="absolute -right-1.5 -top-0.5 flex gap-2"><div class="z-base-1 hidden rounded border group-hover:block border-border-quaternary dark:border-border-quaternary bg-layer-02 dark:bg-layer-02"><div class="relative cursor-pointer flex h-[22px] w-[22px] items-center justify-center bg-layer-02 dark:bg-layer-02 hover:bg-fill-tertiary dark:hover:bg-fill-tertiary rounded-[4px]" data-state="closed"><div><div data-state="closed"><div class="relative text-[12px] leading-[normal] p-[1px] before:block before:h-3 before:w-3 h-3.5 w-3.5 text-text-primary dark:text-text-primary"></div></div></div></div></div></div></div></div>
<p>Problem based on segment tree<br/>
i) XOR SUM<br/>
ii) min/max<br/>
iii) Searching for the first element greater than a given amount</p>
<p>To solve these edit the operation's to be performed in segment tree.</p>
<p>Problem based on Fenwick tree<br/>
i) range update ( can be done using lazy propagation )</p></div></div></div>